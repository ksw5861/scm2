<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.scm.master.mapper.VendorMapper">

  <!-- 거래처 목록 조회 -->
  <select id="getVendorList" resultType="com.yedam.scm.vo.VendorVO">
    SELECT *
    FROM VENDOR
    <where>
      <if test="vendorId != null and vendorId != ''">
        VENDOR_ID = #{vendorId}
      </if>
      <if test="companyName != null and companyName != ''">
        AND COMPANY_NAME LIKE '%' || #{companyName} || '%'
      </if>
      <if test="isActive != null and isActive != ''">
        AND IS_ACTIVE = #{isActive}
      </if>
    </where>
    ORDER BY CREATED_AT DESC
  </select>

  <!-- 거래처 상세 조회 -->
  <select id="getVendorDetail" parameterType="string" resultType="com.yedam.scm.vo.VendorVO">
    SELECT *
    FROM VENDOR
    WHERE VENDOR_ID = #{vendorId}
  </select>

  <!-- 거래처 등록 -->
  <insert id="insertVendor" parameterType="com.yedam.scm.vo.VendorVO">
    INSERT INTO VENDOR (
      VENDOR_ID,
      BUSINESS_REGISTRATION,
      COMPANY_NAME,
      CEO_NAME,
      PHONE_NUMBER,
      ADDRESS,
      IS_ACTIVE,
      CREATED_AT,
      UPDATED_AT,
      TYPE,
      OWNER_NAME,
      OWNER_EMAIL,
      OWNER_TEL
    ) VALUES (
      next_code('VEN'),
      #{businessRegistration},
      #{companyName},
      #{ceoName},
      #{phoneNumber},
      #{address},
      #{isActive},
      sysdate,
      #{updatedAt},
      #{type},
      #{ownerName},
      #{ownerEmail},
      #{ownerTel}
    )
  </insert>

  <!-- 거래처 수정 -->
  <update id="updateVendor" parameterType="com.yedam.scm.vo.VendorVO">
    UPDATE VENDOR
    <set>
      <if test="businessRegistration != null">BUSINESS_REGISTRATION = #{businessRegistration},</if>
      <if test="companyName != null">COMPANY_NAME = #{companyName},</if>
      <if test="ceoName != null">CEO_NAME = #{ceoName},</if>
      <if test="phoneNumber != null">PHONE_NUMBER = #{phoneNumber},</if>
      <if test="address != null">ADDRESS = #{address},</if>
      <if test="isActive != null">IS_ACTIVE = #{isActive},</if>
      <if test="updatedAt != null">UPDATED_AT = sysdate,</if>
      <if test="type != null">TYPE = #{type},</if>
      <if test="ownerName != null">OWNER_NAME = #{ownerName},</if>
      <if test="ownerEmail != null">OWNER_EMAIL = #{ownerEmail},</if>
      <if test="ownerTel != null">OWNER_TEL = #{ownerTel},</if>
    </set>
    WHERE VENDOR_ID = #{vendorId}
  </update>

  <!-- 거래처 삭제 -->
  <delete id="deleteVendor" parameterType="string">
    DELETE FROM VENDOR
    WHERE VENDOR_ID = #{vendorId}
  </delete>

</mapper>
